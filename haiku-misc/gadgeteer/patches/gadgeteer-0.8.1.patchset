From 162946f20eda5fe3422a52cd5e33af88c40029b5 Mon Sep 17 00:00:00 2001
From: Bach Nguyen <bach5000@gmail.com>
Date: Mon, 19 Nov 2018 19:25:49 +0000
Subject: Fix build


diff --git a/Makefile b/Makefile
deleted file mode 120000
index 9b4cc30..0000000
--- a/Makefile
+++ /dev/null
@@ -1 +0,0 @@
-Makefile_RELEASE
\ No newline at end of file
diff --git a/Makefile b/Makefile
new file mode 100644
index 0000000..754a4e1
--- /dev/null
+++ b/Makefile
@@ -0,0 +1,131 @@
+## Haiku Generic Makefile v2.6 ##
+
+## Fill in this file to specify the project being created, and the referenced
+## Makefile-Engine will do all of the hard work for you. This handles any
+## architecture of Haiku.
+
+# The name of the binary.
+NAME = gadgeteer
+
+# The type of binary, must be one of:
+#	APP:	Application
+#	SHARED:	Shared library or add-on
+#	STATIC:	Static library archive
+#	DRIVER: Kernel driver
+TYPE = APP
+
+# 	If you plan to use localization, specify the application's MIME signature.
+APP_MIME_SIG = 
+
+#	The following lines tell Pe and Eddie where the SRCS, RDEFS, and RSRCS are
+#	so that Pe and Eddie can fill them in for you.
+#%{
+# @src->@ 
+
+#	Specify the source files to use. Full paths or paths relative to the 
+#	Makefile can be included. All files, regardless of directory, will have
+#	their object files created in the common object directory. Note that this
+#	means this Makefile will not work correctly if two source files with the
+#	same name (source.c or source.cpp) are included from different directories.
+#	Also note that spaces in folder names do not work well with this Makefile.
+SRCS = Main.cpp  \
+	 Panel.cpp  \
+	 ReadYaml.cpp  \
+	 WMPanel.cpp  \
+	 WMSlider.cpp  \
+
+#	Specify the resource definition files to use. Full or relative paths can be
+#	used.
+RDEFS = gadgeteer.rdef
+	 
+
+
+#	Specify the resource files to use. Full or relative paths can be used.
+#	Both RDEFS and RSRCS can be utilized in the same Makefile.
+RSRCS =
+
+
+# End Pe/Eddie support.
+# @<-src@ 
+#%}
+
+#%}
+
+#	Specify libraries to link against.
+#	There are two acceptable forms of library specifications:
+#	-	if your library follows the naming pattern of libXXX.so or libXXX.a,
+#		you can simply specify XXX for the library. (e.g. the entry for
+#		"libtracker.so" would be "tracker")
+#
+#	-	for GCC-independent linking of standard C++ libraries, you can use
+#		$(STDCPPLIBS) instead of the raw "stdc++[.r4] [supc++]" library names.
+#
+#	- 	if your library does not follow the standard library naming scheme,
+#		you need to specify the path to the library and it's name.
+#		(e.g. for mylib.a, specify "mylib.a" or "path/mylib.a")
+LIBS = $(STDCPPLIBS) be root tracker libyaml.a
+#	Specify additional paths to directories following the standard libXXX.so
+#	or libXXX.a naming scheme. You can specify full paths or paths relative
+#	to the Makefile. The paths included are not parsed recursively, so
+#	include all of the paths where libraries must be found. Directories where
+#	source files were specified are	automatically included.
+LIBPATHS = 
+
+#	Additional paths to look for system headers. These use the form
+#	"#include <header>". Directories that contain the files in SRCS are
+#	NOT auto-included here.
+SYSTEM_INCLUDE_PATHS =  
+
+#	Additional paths paths to look for local headers. These use the form
+#	#include "header". Directories that contain the files in SRCS are
+#	automatically included.
+LOCAL_INCLUDE_PATHS =
+
+#	Specify the level of optimization that you want. Specify either NONE (O0),
+#	SOME (O1), FULL (O2), or leave blank (for the default optimization level).
+OPTIMIZE :=
+
+# 	Specify the codes for languages you are going to support in this
+# 	application. The default "en" one must be provided too. "make catkeys"
+# 	will recreate only the "locales/en.catkeys" file. Use it as a template
+# 	for creating catkeys for other languages. All localization files must be
+# 	placed in the "locales" subdirectory.
+LOCALES = 
+
+#	Specify all the preprocessor symbols to be defined. The symbols will not
+#	have their values set automatically; you must supply the value (if any) to
+#	use. For example, setting DEFINES to "DEBUG=1" will cause the compiler
+#	option "-DDEBUG=1" to be used. Setting DEFINES to "DEBUG" would pass
+#	"-DDEBUG" on the compiler's command line.
+DEFINES = 
+
+#	Specify the warning level. Either NONE (suppress all warnings),
+#	ALL (enable all warnings), or leave blank (enable default warnings).
+WARNINGS = 
+
+#	With image symbols, stack crawls in the debugger are meaningful.
+#	If set to "TRUE", symbols will be created.
+SYMBOLS := 
+
+#	Includes debug information, which allows the binary to be debugged easily.
+#	If set to "TRUE", debug info will be created.
+DEBUGGER := 
+
+#	Specify any additional compiler flags to be used.
+COMPILER_FLAGS = -fpermissive
+
+#	Specify any additional linker flags to be used.
+LINKER_FLAGS = 
+
+#	(Only used when "TYPE" is "DRIVER"). Specify the desired driver install
+#	location in the /dev hierarchy. Example:
+#		DRIVER_PATH = video/usb
+#	will instruct the "driverinstall" rule to place a symlink to your driver's
+#	binary in ~/add-ons/kernel/drivers/dev/video/usb, so that your driver will
+#	appear at /dev/video/usb when loaded. The default is "misc".
+DRIVER_PATH = 
+
+## Include the Makefile-Engine
+DEVEL_DIRECTORY := \
+	$(shell findpaths -r "makefile_engine" B_FIND_PATH_DEVELOP_DIRECTORY)
+include $(DEVEL_DIRECTORY)/etc/makefile-engine
diff --git a/Makefile.RSRCS b/Makefile.RSRCS
deleted file mode 100644
index 4a1c233..0000000
--- a/Makefile.RSRCS
+++ /dev/null
@@ -1 +0,0 @@
-RSRCS = gadgeteer.rsrc
diff --git a/Makefile.SRCS b/Makefile.SRCS
deleted file mode 100644
index c6d73d9..0000000
--- a/Makefile.SRCS
+++ /dev/null
@@ -1,6 +0,0 @@
-SRCS = \
-	Main.cpp \
-	ReadYaml.cpp \
-	Panel.cpp \
-	WMSlider.cpp \
-	WMPanel.cpp
diff --git a/Makefile_DEBUG b/Makefile_DEBUG
deleted file mode 100644
index 859028f..0000000
--- a/Makefile_DEBUG
+++ /dev/null
@@ -1,123 +0,0 @@
-#-------------------------------------------------------
-#
-#	Generic Cross-platform Makefile Base
-#	R4 x86 and ppc binaries
-#
-#  after:
-#		Be Inc. Generic R4 makefile
-#
-#	Original Copyright 1998 Be, Inc.  All Rights Reserved
-#
-#
-#	Fill out the Project Specific Information section
-#	Use a \ to continue information on different lines
-#	example: SRCS = source1.cpp \
-#					source2.cpp
-#
-#	When done simply cd to the directory in the terminal
-#	and type make.  The objects and binary will appear
-#	in an objx86 or objppc folder.
-#
-#--------------------------------------------------------
-
-#--------------------------------------------------------
-#	Project Specific Information
-#--------------------------------------------------------
-
-#	specify the name of the project -- FILL THIS IN!!
-	NAME=gadgeteer
-	
-#	specify the type of image to create
-#		APP:	Application
-#		SHARED:	Shared Library
-#		STATIC:	Static Library
-	TYPE=APP
-	
-#	specify the list of source files
-	## SRCS= 	
-
-include Makefile.SRCS
-
-#	specify the list of resource files
-#	Only resources for the host platform are needed
-	## RSRCS= 
-
-include Makefile.RSRCS
-	
-#	specify additional libraries to link against
-#	there are two acceptable forms of library specifications
-#	-	if your library follows the naming pattern of:
-#		libXXX.so or libXXX.a you can simply specify XXX
-#		library: libbe.so entry: be
-#	  (Note default entry!)
-#		
-#	- 	if your library does not follow the standard library
-#		naming scheme you need to specify the path to the library
-#		and it's name
-#		library: my_lib.a entry: my_lib.a or path/my_lib.a
-LIBS= yaml be
-		
-#	specify additional paths to directories following the standard
-#	libXXX.so or libXXX.a naming scheme.  You can specify full paths
-#	or paths relative to the makefile.  The paths included may not
-#	be recursive, so include all of the paths where libraries can
-#	be found.  Directories where source files are found are
-#	automatically included.
-LIBPATHS= 
-
-#	additional paths to look for system headers
-#	thes use the form: #include <header>
-#	source file directories are NOT auto-included here
-SYSTEM_INCLUDE_PATHS = 
-
-#	additional paths to look for local headers
-#	thes use the form: #include "header"
-#	source file directories are automatically included
-LOCAL_INCLUDE_PATHS = 
-
-#	specify the level of optimization that you desire
-#	NONE, SOME, FULL
-OPTIMIZE= 
-
-#	specify any preprocessor symbols to be defined.  The symbols
-#	will be set to a value of 1.  For example specify DEBUG if you want
-#	DEBUG=1 to be set when compiling.
-DEFINES= 
-
-#	specify special warning levels
-#	if unspecified default warnings will be used
-#	NONE = supress all warnings
-#	ALL = enable all warnings
-WARNINGS = 
-
-#	specify whether image symbols will be created
-#	so that stack crawls in the debugger are meaningful
-#	if TRUE symbols will be created
-SYMBOLS = TRUE
-
-#	specify debug settings
-#	if TRUE will allow application to be run from
-#	a source-level debugger
-DEBUGGER = TRUE
-
-#	specify additional compiler flags for all files
-COMPILER_FLAGS =
-
-#	specify additional linker flags
-LINKER_FLAGS =
-
-
-#####################################################################
-
-## include the makefile-engine
-include /boot/develop/etc/makefile-engine
-
-cleanall::
-	$(MAKE) CPU=ppc clean
-	$(MAKE) CPU=x86 clean
-	
-#	remove just the application from the object folder
-rmapp ::
-	-rm -f $(TARGET)
-
-
diff --git a/Makefile_RELEASE b/Makefile_RELEASE
deleted file mode 100644
index e20db85..0000000
--- a/Makefile_RELEASE
+++ /dev/null
@@ -1,123 +0,0 @@
-#-------------------------------------------------------
-#
-#	Generic Cross-platform Makefile Base
-#	R4 x86 and ppc binaries
-#
-#  after:
-#		Be Inc. Generic R4 makefile
-#
-#	Original Copyright 1998 Be, Inc.  All Rights Reserved
-#
-#
-#	Fill out the Project Specific Information section
-#	Use a \ to continue information on different lines
-#	example: SRCS = source1.cpp \
-#					source2.cpp
-#
-#	When done simply cd to the directory in the terminal
-#	and type make.  The objects and binary will appear
-#	in an objx86 or objppc folder.
-#
-#--------------------------------------------------------
-
-#--------------------------------------------------------
-#	Project Specific Information
-#--------------------------------------------------------
-
-#	specify the name of the project -- FILL THIS IN!!
-	NAME=gadgeteer
-	
-#	specify the type of image to create
-#		APP:	Application
-#		SHARED:	Shared Library
-#		STATIC:	Static Library
-	TYPE=APP
-	
-#	specify the list of source files
-	## SRCS= 	
-
-include Makefile.SRCS
-
-#	specify the list of resource files
-#	Only resources for the host platform are needed
-	## RSRCS= 
-
-include Makefile.RSRCS
-	
-#	specify additional libraries to link against
-#	there are two acceptable forms of library specifications
-#	-	if your library follows the naming pattern of:
-#		libXXX.so or libXXX.a you can simply specify XXX
-#		library: libbe.so entry: be
-#	  (Note default entry!)
-#		
-#	- 	if your library does not follow the standard library
-#		naming scheme you need to specify the path to the library
-#		and it's name
-#		library: my_lib.a entry: my_lib.a or path/my_lib.a
-LIBS= yaml be
-		
-#	specify additional paths to directories following the standard
-#	libXXX.so or libXXX.a naming scheme.  You can specify full paths
-#	or paths relative to the makefile.  The paths included may not
-#	be recursive, so include all of the paths where libraries can
-#	be found.  Directories where source files are found are
-#	automatically included.
-LIBPATHS= 
-
-#	additional paths to look for system headers
-#	thes use the form: #include <header>
-#	source file directories are NOT auto-included here
-SYSTEM_INCLUDE_PATHS = 
-
-#	additional paths to look for local headers
-#	thes use the form: #include "header"
-#	source file directories are automatically included
-LOCAL_INCLUDE_PATHS = 
-
-#	specify the level of optimization that you desire
-#	NONE, SOME, FULL
-OPTIMIZE= 
-
-#	specify any preprocessor symbols to be defined.  The symbols
-#	will be set to a value of 1.  For example specify DEBUG if you want
-#	DEBUG=1 to be set when compiling.
-DEFINES= 
-
-#	specify special warning levels
-#	if unspecified default warnings will be used
-#	NONE = supress all warnings
-#	ALL = enable all warnings
-WARNINGS = 
-
-#	specify whether image symbols will be created
-#	so that stack crawls in the debugger are meaningful
-#	if TRUE symbols will be created
-SYMBOLS = 
-
-#	specify debug settings
-#	if TRUE will allow application to be run from
-#	a source-level debugger
-DEBUGGER = 
-
-#	specify additional compiler flags for all files
-COMPILER_FLAGS =
-
-#	specify additional linker flags
-LINKER_FLAGS =
-
-
-#####################################################################
-
-## include the makefile-engine
-include /boot/develop/etc/makefile-engine
-
-cleanall::
-	$(MAKE) CPU=ppc clean
-	$(MAKE) CPU=x86 clean
-	
-#	remove just the application from the object folder
-rmapp ::
-	-rm -f $(TARGET)
-
-
diff --git a/WMSlider.cpp b/WMSlider.cpp
index 517a2e3..a2a045b 100644
--- a/WMSlider.cpp
+++ b/WMSlider.cpp
@@ -32,15 +32,16 @@ class _WMCntrlSldr : public BSlider
 {
   friend class LSLider;
   public:
-	_WMCntrlSldr(BRect frame, char *title,
-			BStringView *sv,
-			long min, long max, long * valoc,
-			WMSlider * owner);
-	_WMCntrlSldr(BRect frame, char *title,
+		_WMCntrlSldr(BRect frame, char *title,
 			BStringView *sv,
 			float scaling, float offset,
 			int32 places, float * valoc,
 			WMSlider * owner);
+		_WMCntrlSldr(BRect frame, char *title,
+			BStringView *sv,
+			long int min, long int max, long int* valoc,
+			WMSlider * owner);
+
 	void SetValue(int32 v);
 	void SetFValue(float v);
 	float FValue() {return fvalp? *fvalp : NAN;}
@@ -57,7 +58,7 @@ class _WMCntrlSldr : public BSlider
 
 // Note -- 'title' is currently always NULL (Border label used)
 _WMCntrlSldr::_WMCntrlSldr(BRect frame, char *title, 
-			BStringView *sv, long min, long max, long * valoc,
+			BStringView *sv, long int min, long int max, long int *valoc,
 			WMSlider *owner) :
 	BSlider(frame, "slider", title,
 			new BMessage('smup'), min, max, B_BLOCK_THUMB,
@@ -74,7 +75,7 @@ _WMCntrlSldr::_WMCntrlSldr(BRect frame, char *title,
 			BStringView *sv,
 			float scaling, float offset,
 			int32 places, float * valoc,
-			WMSlider * owner) :
+			WMSlider *owner) :
 	BSlider(frame, "slider", title,
 			new BMessage('smup'), 0, 1000, B_BLOCK_THUMB,
 			B_FOLLOW_ALL_SIDES),
@@ -165,7 +166,7 @@ WMSlider::WMSlider(BRect view_frame, int32 min, int32 max,
 	BRect sr(SLIDER_X_PAD, txtspace,
 		 view_bound.Width()-SLIDER_X_PAD - t->Bounds().Width(),
 		  txtspace+10);
-	s = new _WMCntrlSldr(sr, NULL, t, min, max, valoc, this);
+	s = new _WMCntrlSldr(sr, NULL, t, (long int)min, (long int)max, (long int*)valoc, this);
 	s->ResizeTo(s->Bounds().Width(), s->ThumbFrame().Height()+2*SLIDER_Y_PAD);
 	b->AddChild(s);
 	t->MoveTo(s->Frame().RightTop());
diff --git a/demo.sh b/demo.sh
new file mode 100644
index 0000000..52d6405
--- /dev/null
+++ b/demo.sh
@@ -0,0 +1,46 @@
+#! /bin/sh
+
+# A short script to illustrate the use of the "gadgeteer"
+# command-line app.
+
+# A function is needed to let the shell read the output:
+useOutput() {
+  while true; do
+	read TITLE
+	if [ $? != 0 ]; then
+	  return; fi
+	read FIRST
+	read LAST
+	read AGE
+	read CHECK
+	read BUTTON
+	if [ "$BUTTON" ]; then echo "You pressed the button"; continue; fi
+	echo "The name is $TITLE $FIRST $LAST"
+	echo "Age is $AGE"
+	if [ "$CHECK" ]; then echo "and Married"; fi
+  done
+}
+
+# Using shell variables can be convenient:
+  INIT="Billy"
+  
+# The demonstration command line:
+gadgeteer {title: DEMO, label: this is a demonstration, \
+     label: of some gadgeteer features, \
+     menu: [Mr, Mrs, Miss, Ms., Master, Sir, Lady, President, Their Majesty], \
+     width: 300, div: 80, pos: right, textcontrol: {label: First Name, init: $INIT}, \
+     pos: below, textcontrol: LastName, \
+     slider: {label: Age, min: 1, max: 110, init: 21}, \
+     checkbox: {label: Married, init: off}, \
+     button: {label: PUSH ME, width: 50}} | useOutput
+     
+# The command arguments are a YAML-syntax string and thus must be enclosed
+# in braces.  Each 'Directive' entry is a "key: value" pair, separated
+# by commas.  The space after a colon or comma is mandatory.
+
+# By default, items are stacked vertically.  The "pos: right" resets this
+# to put following items to the right of the first, the "pos: below" resets
+# again.  Note that the last item is vertically aligned with the previous.
+# The menu has a list of items as its value; most of the other controls have
+# extended parameter sets as their values.  The "div" global parameter
+# (currently) only applies to the textcontrol divider position.
diff --git a/gadgeteer.rdef b/gadgeteer.rdef
new file mode 100644
index 0000000..5498710
--- /dev/null
+++ b/gadgeteer.rdef
@@ -0,0 +1,16 @@
+
+resource app_signature "application/x-vnd.pjg-gadgeteer";
+
+resource app_version {
+	major  = 0,
+	middle = 8,
+	minor  = 1,
+
+	variety = B_APPV_BETA,
+	internal = 0,
+
+	short_info = "Command Line GUI Interface",
+	long_info = "Display GUI controls from the command-line or shell-script"
+};
+
+resource file_types message;
-- 
2.19.0

